<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAL√ö Chocobananas - Men√∫ y Pedidos</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #1B5E20; /* Darker Brand Green */
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(245, 124, 0, 0.15), transparent 40%),
                radial-gradient(circle at 85% 30%, rgba(134, 239, 172, 0.1), transparent 40%);
            overflow-x: hidden;
            color: #4a4a4a;
        }

        /* Chocobanana floating effect */
        .chocobanana-fall {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .chocobanana-fall div {
            position: absolute;
            top: -200px;
            background-size: contain;
            background-repeat: no-repeat;
            animation: fall-down linear infinite;
            opacity: 0;
        }

        @keyframes fall-down {
            0% { transform: translateY(0) rotate(-20deg); opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% { transform: translateY(120vh) rotate(60deg); opacity: 0; }
        }

        .chocobanana-fall div:nth-child(1) { left: 10%; width: 120px; height: 120px; background-image: url('https://i.postimg.cc/wBJcZcY3/1000670551-removebg-preview.webp'); animation-duration: 22s; animation-delay: 0s; }
        .chocobanana-fall div:nth-child(2) { left: 85%; width: 150px; height: 150px; background-image: url('https://i.postimg.cc/Kz2r2kmf/1000670552-removebg-preview.webp'); animation-duration: 18s; animation-delay: 3s; }
        .chocobanana-fall div:nth-child(3) { left: 50%; width: 100px; height: 100px; background-image: url('https://i.postimg.cc/Hkrt41Sw/1000670553-removebg-preview.webp'); animation-duration: 25s; animation-delay: 8s; }
        .chocobanana-fall div:nth-child(4) { left: 30%; width: 140px; height: 140px; background-image: url('https://i.postimg.cc/vBrgL0FL/1000670549-removebg-preview-1.webp'); animation-duration: 16s; animation-delay: 12s; }
        .chocobanana-fall div:nth-child(5) { left: 65%; width: 110px; height: 110px; background-image: url('https://i.postimg.cc/76n1YH6k/1000670555-removebg-preview.webp'); animation-duration: 28s; animation-delay: 15s; }
        
        /* Brand Colors */
        .brand-green-text { color: #2E7D32; }
        .brand-orange-text { color: #F57C00; }
        .brand-brown-text { color: #3D2B1F; }
        .bg-brand-green { background-color: #2E7D32; }
        .hover\:bg-brand-green-dark:hover { background-color: #1B5E20; }
        .bg-brand-orange { background-color: #F57C00; }
        .hover\:bg-brand-orange-dark:hover { background-color: #E65100; }
        
        /* Cart Modal Styles */
        .cart-modal {
            position: fixed; top: 0; right: -100%; width: 100%; max-width: 450px; height: 100%;
            background: white; z-index: 1001; color: #1f2937;
            transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: flex; flex-direction: column;
        }
        .cart-modal.open { right: 0; }
        .cart-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); z-index: 1000;
            opacity: 0; visibility: hidden; transition: opacity 0.4s, visibility 0.4s;
        }
        .cart-overlay.visible { opacity: 1; visibility: visible; }
    </style>
</head>
<body class="text-gray-800">

    <div class="chocobanana-fall">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>

    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-6 py-2 flex justify-between items-center">
            <a href="#" class="flex items-center gap-3">
                <img src="https://scontent.fptz1-1.fna.fbcdn.net/v/t1.6435-9/120623817_2756311547940742_4877580013596553030_n.jpg?_nc_cat=100&ccb=1-7&_nc_sid=833d8c&_nc_ohc=mEQdu5xSycAQ7kNvwE9MaZS&_nc_oc=AdnW_LwBOBKzbCLPJnbHYRBLDwy5nb364G1MWPuam_DZujGlsV5ZDpXZmdvwVCTsOXE&_nc_zt=23&_nc_ht=scontent.fptz1-1.fna&_nc_gid=M5h8cPgjuu5YT6FtW6pIEA&oh=00_AfS4lCBjAcVVSa0Z9FIvD4nhb3rxEoMRffX247tuX_KEtw&oe=68B1EA8A" alt="Logo de VAL√ö Chocobananas" class="h-20 md:h-24 transition-all" onerror="this.onerror=null;this.src='https://placehold.co/96x96/FFF3E0/3D2B1F?text=V';">
            </a>
            <nav class="hidden md:flex items-center gap-6 font-semibold brand-brown-text">
                <a href="#productos" class="hover:brand-orange-text transition-colors">Productos</a>
                <a href="#experiencia" class="hover:brand-orange-text transition-colors">Experiencia</a>
                <a href="#footer-contact" class="hover:brand-orange-text transition-colors">Contacto</a>
            </nav>
            <button id="cart-button" class="relative bg-brand-orange text-white px-4 py-2 rounded-full font-bold hover:bg-brand-orange-dark transition-colors flex items-center gap-2">
                <i class="fas fa-shopping-cart"></i>
                <span class="hidden sm:inline">Carrito</span>
                <span id="cart-count" class="absolute -top-2 -right-2 bg-brand-green text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
            </button>
        </div>
    </header>

    <main class="relative z-10">
        <section class="py-20 md:py-24">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-extrabold leading-tight mb-4 text-white" style="text-shadow: 2px 2px 8px rgba(0,0,0,0.5);">M√°s que un postre, una experiencia.</h1>
                <p class="text-lg md:text-xl max-w-3xl mx-auto text-gray-300">Te esperamos en nuestro ambiente confortable que huele riqu√≠simo. Descubre una amplia carta de chocobananas que no sabr√°s cu√°l elegir.</p>
            </div>
        </section>

        <section id="experiencia" class="pb-16">
            <div class="container mx-auto px-6">
                <div class="bg-white rounded-2xl shadow-xl p-8 md:p-12 md:flex items-center gap-12">
                    <div class="md:w-1/2 mb-8 md:mb-0">
                        <img src="https://i.postimg.cc/htnht0Qv/504974765-1058337899724199-7091260268685360836-n.webp" alt="Interior del local de VAL√ö Chocobananas" class="rounded-lg shadow-lg w-full h-auto" onerror="this.onerror=null;this.src='https://placehold.co/600x400/FFF3E0/3D2B1F?text=Local';">
                    </div>
                    <div class="md:w-1/2">
                        <h2 class="text-3xl font-bold mb-4 brand-green-text">Nuestra Experiencia <span class="brand-orange-text">VAL√ö</span></h2>
                        <p class="mb-4 text-gray-600">Tu rinc√≥n favorito en el coraz√≥n de Shushufindi. Nacimos para convertir un postre cl√°sico en una experiencia inolvidable. Nos enorgullece ofrecerte la m√°s amplia y deliciosa carta de chocobananas que puedas imaginar.</p>
                        <p class="text-gray-600">M√°s que solo un producto, queremos que te sientas como en casa. Por eso, hemos creado un espacio amplio, confortable y con un ambiente s√∫per acogedor. ¬°Somos el punto de encuentro perfecto para todos los "Val√∫ Lovers"!</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="productos" class="py-16">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl font-bold mb-12 text-center text-white" style="text-shadow: 2px 2px 8px rgba(0,0,0,0.5);">Nuestros Sabores</h2>
                <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-12">
                    <!-- Product cards will be injected here by JavaScript -->
                </div>
            </div>
        </section>
    </main>

    <footer id="footer-contact" class="bg-gray-900/80 text-gray-300 pt-12 pb-8 mt-16 border-t border-white/10 relative z-10">
        <div class="container mx-auto px-6 text-center">
             <div class="grid md:grid-cols-3 gap-8">
                <div class="mb-6 md:mb-0"><h4 class="font-bold text-lg mb-2 text-white">Contacto</h4><p><i class="fab fa-whatsapp mr-2"></i> +593 96 049 9387</p><p><i class="fas fa-envelope mr-2"></i> valuchocobananas@gmail.com</p></div>
                <div class="mb-6 md:mb-0"><h4 class="font-bold text-lg mb-2 text-white">Ubicaci√≥n</h4><a href="https://maps.app.goo.gl/ZjvLQER2vHgL6kSQ6" target="_blank" class="inline-block hover:text-white transition-colors"><i class="fas fa-map-marker-alt mr-2"></i> Siona y 7 de agosto</a><p>Shushufindi, Ecuador</p></div>
                <div class="mb-6 md:mb-0"><h4 class="font-bold text-lg mb-2 text-white">Horario</h4><p>Lunes a S√°bado</p><p>3:00 PM - 7:30 PM</p></div>
            </div>
            <div class="mt-8 pt-8 border-t border-white/20 text-sm text-white/70">
                <p>&copy; 2024 VAL√ö Chocobananas. Todos los derechos reservados.</p>
                <!-- Bot & Landing promotional footer -->
                <div class="mt-4">
                    <p class="text-xs text-white/50">
                        Desarrollado con ‚ù§Ô∏è por 
                        <a href="https://wa.me/593999630862?text=Hola%20Bot%20&%20Landing,%20estoy%20interesado%20en%20una%20p√°gina%20web%20como%20la%20de%20VAL√ö%20Chocobananas." target="_blank" class="font-bold text-white/70 hover:text-white transition-colors">
                            Bot & Landing
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Cart Modal -->
    <div id="cart-overlay" class="cart-overlay"></div>
    <div id="cart-modal" class="cart-modal shadow-2xl">
        <div class="flex justify-between items-center p-4 border-b">
            <h2 class="text-2xl font-bold text-gray-800">Tu Pedido</h2>
            <button id="close-cart-button" class="text-2xl text-gray-500 hover:text-gray-800">&times;</button>
        </div>
        
        <div id="cart-items" class="flex-grow p-4 overflow-y-auto">
            <!-- Cart items will be injected here -->
        </div>

        <div class="p-4 border-t bg-gray-50">
            <div class="flex justify-between items-center font-bold text-xl mb-4 text-gray-800">
                <span>Total:</span>
                <span id="cart-total">$0.00</span>
            </div>
            <div id="checkout-form" class="hidden">
                <!-- Bank Details Section -->
                <div class="bg-blue-50 border border-blue-200 text-blue-800 p-3 rounded-lg mb-4 text-sm">
                    <h4 class="font-bold mb-2 text-center">Datos para Transferencia</h4>
                    <p><strong>Banco:</strong> Banco Pichincha</p>
                    <p><strong>Cuenta de Ahorros:</strong> 1234567890</p>
                    <p><strong>A nombre de:</strong> VAL√ö Chocobananas S.A.S</p>
                    <p><strong>RUC/CI:</strong> 1234567890001</p>
                </div>

                <h3 class="font-bold text-lg mb-3 text-center text-gray-800">Completa tus datos para enviar</h3>
                <input type="text" id="customer-name" placeholder="Tu Nombre Completo *" required class="w-full border-2 p-2 rounded-lg mb-2 focus:border-orange-400 focus:outline-none">
                <input type="tel" id="customer-phone" placeholder="Tu N√∫mero de WhatsApp *" required class="w-full border-2 p-2 rounded-lg mb-2 focus:border-orange-400 focus:outline-none">
                <textarea id="customer-address" placeholder="Tu Direcci√≥n y Referencia *" required rows="2" class="w-full border-2 p-2 rounded-lg mb-2 focus:border-orange-400 focus:outline-none"></textarea>
                
                <!-- Location and Payment Proof Buttons -->
                <div class="grid grid-cols-2 gap-2 mb-4">
                    <button id="share-location-btn" class="w-full bg-blue-500 text-white text-sm font-bold py-2 px-2 rounded-full hover:bg-blue-600 transition-colors flex items-center justify-center gap-1">
                        <i class="fas fa-map-marker-alt"></i> Compartir Ubicaci√≥n
                    </button>
                    <label for="payment-proof-input" class="w-full bg-gray-500 text-white text-sm font-bold py-2 px-2 rounded-full hover:bg-gray-600 transition-colors flex items-center justify-center gap-1 cursor-pointer">
                        <i class="fas fa-paperclip"></i> Adjuntar Comprobante
                    </label>
                    <input type="file" id="payment-proof-input" class="hidden" accept="image/*">
                </div>
                <p id="location-status" class="text-xs text-center text-green-600 font-semibold mb-2"></p>
                <p id="payment-status" class="text-xs text-center text-green-600 font-semibold mb-2"></p>

                <p class="text-xs text-gray-500 mb-4">* Campos obligatorios</p>
                <button id="send-order-button" class="w-full bg-green-500 text-white font-bold py-3 rounded-full hover:bg-green-600 transition-colors flex items-center justify-center gap-2">
                    <i class="fab fa-whatsapp"></i> Enviar Pedido por WhatsApp
                </button>
            </div>
            <button id="checkout-button" class="w-full bg-brand-orange text-white font-bold py-3 rounded-full hover:bg-brand-orange-dark transition-colors">
                Continuar al Pago
            </button>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 bg-black/60 z-[1002] flex items-center justify-center p-4 transition-opacity duration-300 opacity-0 pointer-events-none">
        <div class="bg-white rounded-xl p-8 text-center shadow-2xl max-w-sm transform scale-95 transition-transform duration-300">
            <i class="fas fa-check-circle text-green-500 text-5xl mb-4"></i>
            <h2 class="text-2xl font-bold brand-brown-text mb-2">¬°Gracias por tu compra!</h2>
            <p class="text-gray-600 mb-6">Hemos abierto WhatsApp para que env√≠es tu pedido. ¬°Lo prepararemos enseguida!</p>
            <button id="close-confirmation-btn" class="bg-brand-green text-white font-bold py-2 px-6 rounded-full">Entendido</button>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const products = [
            { id: 1, name: 'Crujiente de Man√≠', price: 1.00, img: 'https://i.postimg.cc/wBJcZcY3/1000670551-removebg-preview.webp', desc: 'La combinaci√≥n perfecta de chocolate cremoso y man√≠ tostado. ¬°Un cl√°sico irresistible!' },
            { id: 2, name: 'Fiesta de Chispas', price: 1.00, img: 'https://i.postimg.cc/Kz2r2kmf/1000670552-removebg-preview.webp', desc: 'Ba√±ada en chocolate y cubierta con una explosi√≥n de grageas de colores. ¬°Pura diversi√≥n!' },
            { id: 3, name: 'Sue√±o Blanco', price: 1.00, img: 'https://i.postimg.cc/Hkrt41Sw/1000670553-removebg-preview.webp', desc: 'Delicado chocolate blanco con chispas de chocolate oscuro. ¬°Un contraste delicioso!' },
            { id: 4, name: 'Galleta Man√≠a', price: 1.00, img: 'https://i.postimg.cc/vBrgL0FL/1000670549-removebg-preview-1.webp', desc: 'Tu galleta favorita triturada sobre una capa de chocolate. ¬°La mejor combinaci√≥n!' },
            { id: 5, name: 'Choco-Chispas', price: 1.00, img: 'https://i.postimg.cc/BnRBm7yd/1000670554-removebg-preview.webp', desc: 'Para los verdaderos amantes del chocolate. ¬°Doble dosis de sabor y textura!' },
            { id: 6, name: 'Nieve de Coco', price: 1.00, img: 'https://i.postimg.cc/76n1YH6k/1000670555-removebg-preview.webp', desc: 'Un viaje tropical con cada mordida. Ba√±ada en chocolate y cubierta de coco fresco.' },
            { id: 7, name: 'Coraz√≥n de Amor', price: 1.00, img: 'https://i.postimg.cc/j2qHDpwJ/1000670557-removebg-preview.webp', desc: 'El cl√°sico de chocolate con un toque especial de amor. ¬°Ideal para compartir!' },
            { id: 8, name: 'Doble Chocolate', price: 1.00, img: 'https://i.postimg.cc/VL69mcPx/IMG-20250809-165122-573-2-removebg-preview.webp', desc: 'Base de chocolate oscuro con un elegante decorado de chocolate blanco.' },
            { id: 9, name: 'Explosi√≥n Crujiente', price: 1.00, img: 'https://i.postimg.cc/nrdvB3BS/1000670562-removebg-preview.webp', desc: 'Una capa de chocolate cubierta con arroz inflado achocolatado. ¬°S√∫per crujiente!' },
            { id: 10, name: 'Fresa Pasi√≥n', price: 1.00, img: 'https://i.postimg.cc/rygGBw3G/IMG-20250809-170227-751-2-removebg-preview.webp', desc: 'Una dulce cobertura de chocolate con un toque de fresa y decoraciones rom√°nticas.' },
            { id: 11, name: 'Almendra Tostada', price: 1.00, img: 'https://i.postimg.cc/VLVqNHYd/IMG-20250809-171929-053-2-removebg-preview.webp', desc: 'Chocolate premium cubierto con trocitos de almendra tostada para un sabor sofisticado.' }
        ];

        const productList = document.getElementById('product-list');
        const cartButton = document.getElementById('cart-button');
        const closeCartButton = document.getElementById('close-cart-button');
        const cartModal = document.getElementById('cart-modal');
        const cartOverlay = document.getElementById('cart-overlay');
        const cartItemsContainer = document.getElementById('cart-items');
        const cartTotalEl = document.getElementById('cart-total');
        const cartCountEl = document.getElementById('cart-count');
        const checkoutButton = document.getElementById('checkout-button');
        const checkoutForm = document.getElementById('checkout-form');
        const sendOrderButton = document.getElementById('send-order-button');
        const shareLocationBtn = document.getElementById('share-location-btn');
        const paymentProofInput = document.getElementById('payment-proof-input');
        const locationStatus = document.getElementById('location-status');
        const paymentStatus = document.getElementById('payment-status');
        const confirmationModal = document.getElementById('confirmation-modal');
        const closeConfirmationBtn = document.getElementById('close-confirmation-btn');

        let cart = {};
        let sharedLocation = null;
        let paymentProofFile = null;

        // 1. Render Products
        function renderProducts() {
            productList.innerHTML = '';
            products.forEach(product => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-xl text-center overflow-hidden flex flex-col shadow-lg transition-all duration-300 ease-in-out hover:shadow-2xl hover:scale-105 hover:-translate-y-2';
                card.innerHTML = `
                    <div class="bg-gray-50"><img src="${product.img}" alt="${product.name}" class="w-full h-56 object-contain" onerror="this.onerror=null;this.src='https://placehold.co/400x224/ffffff/3D2B1F?text=${product.name}';"></div>
                    <div class="p-6 flex-grow flex flex-col">
                        <h3 class="text-xl font-bold mb-2 brand-brown-text">${product.name}</h3>
                        <p class="text-sm flex-grow text-gray-600">${product.desc}</p>
                        <p class="font-bold brand-orange-text mt-2 text-lg">$${product.price.toFixed(2)}</p>
                        <button class="add-to-cart-btn mt-4 bg-brand-green text-white font-bold py-2 px-4 rounded-full hover:bg-brand-green-dark transition-colors" data-id="${product.id}">
                            A√±adir al Carrito
                        </button>
                    </div>
                `;
                productList.appendChild(card);
            });
        }

        // 2. Cart Logic (addToCart, updateQuantity, updateCart)
        function addToCart(productId) {
            if (cart[productId]) {
                cart[productId].quantity++;
            } else {
                const product = products.find(p => p.id == productId);
                cart[productId] = { ...product, quantity: 1 };
            }
            updateCart();
        }

        function updateQuantity(productId, newQuantity) {
            if (cart[productId]) {
                if (newQuantity > 0) {
                    cart[productId].quantity = newQuantity;
                } else {
                    delete cart[productId];
                }
                updateCart();
            }
        }

        function updateCart() {
            cartItemsContainer.innerHTML = '';
            let total = 0;
            let totalItems = 0;

            if (Object.keys(cart).length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-center text-gray-500 py-8">Tu carrito est√° vac√≠o.</p>';
                checkoutButton.classList.add('hidden');
                checkoutForm.classList.add('hidden');
            } else {
                checkoutButton.classList.remove('hidden');
                for (const id in cart) {
                    const item = cart[id];
                    total += item.price * item.quantity;
                    totalItems += item.quantity;
                    const itemEl = document.createElement('div');
                    itemEl.className = 'flex items-center gap-4 py-3 border-b';
                    itemEl.innerHTML = `
                        <img src="${item.img}" class="w-16 h-16 object-contain rounded-md bg-gray-100" onerror="this.onerror=null;this.src='https://placehold.co/64x64/e0e7ff/302b63?text=V';">
                        <div class="flex-grow">
                            <h4 class="font-bold text-gray-800">${item.name}</h4>
                            <p class="text-sm text-gray-600">$${item.price.toFixed(2)}</p>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="number" value="${item.quantity}" min="1" class="w-14 border-2 text-center rounded-md quantity-input" data-id="${id}">
                            <button class="text-red-500 hover:text-red-700 remove-btn text-xl" data-id="${id}">&times;</button>
                        </div>
                    `;
                    cartItemsContainer.appendChild(itemEl);
                }
            }

            cartTotalEl.textContent = `$${total.toFixed(2)}`;
            cartCountEl.textContent = totalItems;
        }

        // 3. Event Listeners
        productList.addEventListener('click', (e) => {
            if (e.target.classList.contains('add-to-cart-btn')) {
                const id = e.target.dataset.id;
                addToCart(id);
                e.target.textContent = '¬°A√±adido!';
                setTimeout(() => { e.target.textContent = 'A√±adir al Carrito'; }, 1000);
            }
        });

        cartItemsContainer.addEventListener('change', (e) => {
            if (e.target.classList.contains('quantity-input')) {
                const id = e.target.dataset.id;
                const quantity = parseInt(e.target.value, 10);
                updateQuantity(id, quantity);
            }
        });

        cartItemsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('remove-btn')) {
                const id = e.target.dataset.id;
                updateQuantity(id, 0);
            }
        });

        cartButton.addEventListener('click', () => {
            cartModal.classList.add('open');
            cartOverlay.classList.add('visible');
        });

        closeCartButton.addEventListener('click', () => {
            cartModal.classList.remove('open');
            cartOverlay.classList.remove('visible');
        });

        cartOverlay.addEventListener('click', () => {
            cartModal.classList.remove('open');
            cartOverlay.classList.remove('visible');
        });

        checkoutButton.addEventListener('click', () => {
            checkoutButton.classList.add('hidden');
            checkoutForm.classList.remove('hidden');
        });

        shareLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                locationStatus.textContent = 'Obteniendo ubicaci√≥n...';
                navigator.geolocation.getCurrentPosition(position => {
                    const { latitude, longitude } = position.coords;
                    sharedLocation = `https://www.google.com/maps?q=${latitude},${longitude}`;
                    locationStatus.textContent = '¬°Ubicaci√≥n compartida!';
                }, () => {
                    locationStatus.textContent = 'No se pudo obtener la ubicaci√≥n.';
                });
            } else {
                locationStatus.textContent = 'Geolocalizaci√≥n no es soportada.';
            }
        });

        paymentProofInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                paymentProofFile = e.target.files[0];
                paymentStatus.textContent = `Archivo: ${paymentProofFile.name}`;
            } else {
                paymentProofFile = null;
                paymentStatus.textContent = '';
            }
        });

        sendOrderButton.addEventListener('click', () => {
            const name = document.getElementById('customer-name').value.trim();
            const phone = document.getElementById('customer-phone').value.trim();
            const address = document.getElementById('customer-address').value.trim();

            if (!name || !phone || !address) {
                alert('Por favor, completa todos los campos obligatorios (*).');
                return;
            }

            let message = `¬°Hola VAL√ö Chocobananas! üëã Quisiera hacer el siguiente pedido:\n\n`;
            let total = 0;

            for (const id in cart) {
                const item = cart[id];
                message += `*${item.quantity}x* - ${item.name}\n`;
                total += item.price * item.quantity;
            }

            message += `\n*Total del Pedido: $${total.toFixed(2)}*\n\n`;
            message += `*Mis Datos de Entrega:*\n`;
            message += `*Nombre:* ${name}\n`;
            message += `*WhatsApp:* ${phone}\n`;
            message += `*Direcci√≥n:* ${address}\n`;

            if (sharedLocation) {
                message += `*Ubicaci√≥n (Google Maps):* ${sharedLocation}\n`;
            }
            if (paymentProofFile) {
                message += `\n*Adjunto el comprobante de pago en el siguiente mensaje.*`;
            }

            message += `\n¬°Espero su confirmaci√≥n! Gracias. üòä`;
            
            const whatsappNumber = '593960499387';
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;

            window.open(whatsappUrl, '_blank');
            showConfirmationModal();
        });

        function showConfirmationModal() {
            confirmationModal.classList.remove('opacity-0', 'pointer-events-none');
            confirmationModal.querySelector('div').classList.remove('scale-95');
        }

        function hideConfirmationModal() {
            confirmationModal.classList.add('opacity-0', 'pointer-events-none');
            confirmationModal.querySelector('div').classList.add('scale-95');
            
            // Reset form and cart
            cart = {};
            sharedLocation = null;
            paymentProofFile = null;
            updateCart();
            checkoutForm.classList.add('hidden');
            document.getElementById('customer-name').value = '';
            document.getElementById('customer-phone').value = '';
            document.getElementById('customer-address').value = '';
            paymentProofInput.value = '';
            locationStatus.textContent = '';
            paymentStatus.textContent = '';
            cartModal.classList.remove('open');
            cartOverlay.classList.remove('visible');
        }

        closeConfirmationBtn.addEventListener('click', hideConfirmationModal);

        // Initial Load
        renderProducts();
        updateCart();
    });
    </script>
</body>
</html>
